<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Customisation & Extensions" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://pypcapkit.jarryshaw.me/ext.html" />
<meta property="og:site_name" content="PyPCAPKit" />
<meta property="og:description" content="pcapkit is designed with extensive ability in customisation and extension. It is easy to add new protocols, layers, fields, and even new file formats. This section will introduce how to customise a..." />
<meta name="description" content="pcapkit is designed with extensive ability in customisation and extension. It is easy to add new protocols, layers, fields, and even new file formats. This section will introduce how to customise a..." />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="How to …" href="demo.html" /><link rel="prev" title="HTTP Vendor Crawler" href="pcapkit/vendor/http.html" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
        <title>Customisation &amp; Extensions - PyPCAPKit</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --font-stack: Georgia, serif;
  --font-stack--monospace: 'Consolas', 'Menlo', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', monospace;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --font-stack: Georgia, serif;
  --font-stack--monospace: 'Consolas', 'Menlo', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', monospace;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --font-stack: Georgia, serif;
  --font-stack--monospace: 'Consolas', 'Menlo', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', monospace;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyPCAPKit</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">PyPCAPKit</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="pcapkit/index.html">Module Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Module Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="pcapkit/interface/index.html">User Interface</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of User Interface</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/interface/core.html">Core Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/interface/misc.html">Auxiliary Interface</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pcapkit/foundation/index.html">Library Foundation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Library Foundation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/foundation/extraction.html">File Extractor</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pcapkit/foundation/engines/index.html">Engine Support</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Engine Support</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/foundation/engines/engine.html">Base Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/foundation/engines/builtin.html">Built-in Engines</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/foundation/engines/3rdparty.html">3rd-Party Engines</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pcapkit/foundation/reassembly/index.html">Packets Reassembly</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Packets Reassembly</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/foundation/reassembly/reassembly.html">Base Class</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="pcapkit/foundation/reassembly/ip/index.html">IP Datagram Reassembly</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of IP Datagram Reassembly</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="pcapkit/foundation/reassembly/ip/ip.html">Base Class</a></li>
<li class="toctree-l5"><a class="reference internal" href="pcapkit/foundation/reassembly/ip/ipv4.html">IPv4 Datagram Reassembly</a></li>
<li class="toctree-l5"><a class="reference internal" href="pcapkit/foundation/reassembly/ip/ipv6.html">IPv6 Datagram Reassembly</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/foundation/reassembly/tcp.html">TCP Datagram Reassembly</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pcapkit/foundation/traceflow/index.html">Flow Tracing</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Flow Tracing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/foundation/traceflow/traceflow.html">Base Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/foundation/traceflow/tcp.html">Follow TCP Stream</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/foundation/registry.html">Registry Management</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pcapkit/protocols/index.html">Protocol Family</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Protocol Family</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/protocols/protocol.html">Root Protocol</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pcapkit/protocols/link/index.html">Link Layer</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Link Layer</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/link/link.html">Base Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/link/ethernet.html">Ethernet Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/link/arp.html">ARP/InARP - (Inverse) Address Resolution Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/link/rarp.html">RARP/DRARP - (Dynamic) Reverse Address Resolution Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/link/l2tp.html">L2TP - Layer Two Tunnelling Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/link/ospf.html">OSPF - Open Shortest Path First</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/link/vlan.html">VLAN - 802.1Q Customer VLAN Tag Type</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pcapkit/protocols/internet/index.html">Internet Layer</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Internet Layer</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/internet/internet.html">Base Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/internet/ip.html">IP - Internet Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/internet/ipv4.html">IPv4 - Internet Protocol version 4</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/internet/ipv6.html">IPv6 - Internet Protocol version 6</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/internet/ipv6_frag.html">IPv6-Frag - Fragment Header for IPv6</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/internet/ipv6_opts.html">IPv6-Opts - Destination Options for IPv6</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/internet/ipv6_route.html">IPv6-Route - Routing Header for IPv6</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/internet/hopopt.html">HOPOPT - IPv6 Hop-by-Hop Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/internet/ipsec.html">IPsec - Internet Protocol Security</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/internet/ah.html">AH - Authentication Header</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/internet/hip.html">HIP - Host Identity Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/internet/mh.html">MH - Mobility Header</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/internet/ipx.html">IPX - Internetwork Packet Exchange</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pcapkit/protocols/transport/index.html">Transport Layer</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Transport Layer</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/transport/transport.html">Base Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/transport/tcp.html">TCP - Transmission Control Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/transport/udp.html">UDP - User Datagram Protocol</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pcapkit/protocols/application/index.html">Application Layer</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Application Layer</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/application/application.html">Base Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/application/http.html">HTTP - Hypertext Transfer Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/application/httpv1.html">HTTP/1.* - Hypertext Transfer Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/application/httpv2.html">HTTP/2 - Hypertext Transfer Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/application/ftp.html">FTP - File Transfer Protocol</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pcapkit/protocols/misc/index.html">Auxiliary Protocols</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Auxiliary Protocols</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/misc/pcap.html">PCAP File Headers</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/misc/pcapng.html">PCAP-NG File Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/misc/raw.html">Raw Packet Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/protocols/misc/null.html">No-Payload Packet</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pcapkit/corekit/index.html">Core Utilities</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Core Utilities</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="pcapkit/corekit/fields/index.html">Protocol Fields</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Protocol Fields</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/corekit/fields/field.html">Base Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/corekit/fields/numbers.html">Numerical Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/corekit/fields/strings.html">Text Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/corekit/fields/ipaddress.html">IP Address Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/corekit/fields/collections.html">Container Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="pcapkit/corekit/fields/misc.html">Miscellaneous Fields</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/corekit/infoclass.html">Info Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/corekit/io.html">Seekable I/O Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/corekit/module.html">Module Descriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/corekit/multidict.html">Multi-Mapping Dictionary</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/corekit/protochain.html">Protocol Chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/corekit/version.html">Version Info</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pcapkit/toolkit/index.html">Compatibility Tools</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Compatibility Tools</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/toolkit/builtin.html">Built-in Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/toolkit/3rdparty.html">3rd-Party Support</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pcapkit/dumpkit/index.html">Dump Utilities</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Dump Utilities</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/dumpkit/pcap.html">PCAP Dumper</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/dumpkit/null.html">Null Dumper</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/dumpkit/common.html">Common Utilities</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pcapkit/utilities/index.html">Module Utilities</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Module Utilities</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/utilities/functools.html">Auxiliary Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/utilities/exceptions.html">User Defined Exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/utilities/warnings.html">User Defined Warnings</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pcapkit/const/index.html">Constant Enumerations</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Constant Enumerations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/const/reg.html">Protocol Type Registry Constant Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/const/pcapng.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">PCAPNG</span></code> Constant Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/const/arp.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">ARP</span></code> Constant Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/const/l2tp.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">L2TP</span></code> Constant Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/const/ospf.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">OSPF</span></code> Constant Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/const/vlan.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">VLAN</span></code> Constant Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/const/hip.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">HIP</span></code> Constant Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/const/ipv4.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPv4</span></code> Constant Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/const/ipv6.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPv6</span></code> Constant Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/const/ipx.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPX</span></code> Constant Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/const/mh.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">MH</span></code> Constant Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/const/tcp.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">TCP</span></code> Constant Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/const/ftp.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">FTP</span></code> Constant Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/const/http.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTTP</span></code> Constant Enumerations</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pcapkit/vendor/index.html">Vendor Crawlers</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Vendor Crawlers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/default.html">Base Crawler</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/reg.html">Protocol Type Registry Vendor Crawlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/pcapng.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">PCAPNG</span></code> Vendor Crawlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/arp.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">ARP</span></code> Vendor Crawlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/l2tp.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">L2TP</span></code> Vendor Crawlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/ospf.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">OSPF</span></code> Vendor Crawlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/vlan.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">VLAN</span></code> Vendor Crawlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/hip.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">HIP</span></code> Vendor Crawler</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/ipv4.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPv4</span></code> Vendor Crawlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/ipv6.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPv6</span></code> Vendor Crawlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/ipx.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPX</span></code> Vendor Crawlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/mh.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">MH</span></code> Vendor Crawlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/tcp.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">TCP</span></code> Vendor Crawlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/ftp.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">FTP</span></code> Vendor Crawler</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcapkit/vendor/http.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTTP</span></code> Vendor Crawler</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Customisation &amp; Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo.html">How to …</a></li>
<li class="toctree-l1"><a class="reference internal" href="pep.html">Help Wanted</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/JarryShaw/PyPCAPKit/blob/master/docs/source/ext.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/JarryShaw/PyPCAPKit/edit/master/docs/source/ext.rst" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="customisation-extensions">
<h1>Customisation &amp; Extensions<a class="headerlink" href="#customisation-extensions" title="Link to this heading">¶</a></h1>
<p><a class="reference internal" href="pcapkit/index.html#module-pcapkit" title="pcapkit"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit</span></code></a> is designed with extensive ability in customisation and
extension. It is easy to add new protocols, layers, fields, and even new file
formats. This section will introduce how to customise and extend <a class="reference internal" href="pcapkit/index.html#module-pcapkit" title="pcapkit"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit</span></code></a>
to meet your own needs.</p>
<section id="what-s-in-for-protocols">
<h2>What’s in for Protocols?<a class="headerlink" href="#what-s-in-for-protocols" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="pcapkit/protocols/protocol.html#pcapkit.protocols.protocol.Protocol" title="pcapkit.protocols.protocol.Protocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></a> is the most essential concept
and class in <a class="reference internal" href="pcapkit/index.html#module-pcapkit" title="pcapkit"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit</span></code></a>. Every protocol is represented by a
<a class="reference internal" href="pcapkit/protocols/protocol.html#pcapkit.protocols.protocol.Protocol" title="pcapkit.protocols.protocol.Protocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></a> subclass, which is responsible
for parsing and/or constructing the protocol packets, as in the network stack.</p>
<p>The following table shows all available protocol classes in <a class="reference internal" href="pcapkit/index.html#module-pcapkit" title="pcapkit"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit</span></code></a>:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Protocol Type</p></th>
<th class="head" colspan="4"><p>Protocol Class</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="8"><p>Link Layer
(<a class="reference internal" href="pcapkit/protocols/link/link.html#pcapkit.protocols.link.link.Link" title="pcapkit.protocols.link.link.Link"><code class="xref py py-class docutils literal notranslate"><span class="pre">Link</span></code></a> subclasses)</p></td>
<td rowspan="4"><p>ARP Family</p></td>
<td colspan="3"><p><a class="reference internal" href="pcapkit/protocols/link/arp.html#pcapkit.protocols.link.arp.ARP" title="pcapkit.protocols.link.arp.ARP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.link.arp.ARP</span></code></a></p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p><a class="reference internal" href="pcapkit/protocols/link/arp.html#pcapkit.protocols.link.arp.InARP" title="pcapkit.protocols.link.arp.InARP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.link.arp.InARP</span></code></a></p></td>
</tr>
<tr class="row-even"><td colspan="2" rowspan="2"><p>RARP Family</p></td>
<td><p><a class="reference internal" href="pcapkit/protocols/link/rarp.html#pcapkit.protocols.link.rarp.RARP" title="pcapkit.protocols.link.rarp.RARP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.link.rarp.RARP</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/protocols/link/rarp.html#pcapkit.protocols.link.rarp.DRARP" title="pcapkit.protocols.link.rarp.DRARP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.link.rarp.DRARP</span></code></a></p></td>
</tr>
<tr class="row-even"><td colspan="4"><p><a class="reference internal" href="pcapkit/protocols/link/ethernet.html#pcapkit.protocols.link.ethernet.Ethernet" title="pcapkit.protocols.link.ethernet.Ethernet"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.link.ethernet.Ethernet</span></code></a></p></td>
</tr>
<tr class="row-odd"><td colspan="4"><p><a class="reference internal" href="pcapkit/protocols/link/l2tp.html#pcapkit.protocols.link.l2tp.L2TP" title="pcapkit.protocols.link.l2tp.L2TP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.link.l2tp.L2TP</span></code></a></p></td>
</tr>
<tr class="row-even"><td colspan="4"><p><a class="reference internal" href="pcapkit/protocols/link/ospf.html#pcapkit.protocols.link.ospf.OSPF" title="pcapkit.protocols.link.ospf.OSPF"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.link.ospf.OSPF</span></code></a></p></td>
</tr>
<tr class="row-odd"><td colspan="4"><p><a class="reference internal" href="pcapkit/protocols/link/vlan.html#pcapkit.protocols.link.vlan.VLAN" title="pcapkit.protocols.link.vlan.VLAN"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.link.vlan.VLAN</span></code></a></p></td>
</tr>
<tr class="row-even"><td rowspan="12"><p>Internet Layer
(<a class="reference internal" href="pcapkit/protocols/internet/internet.html#pcapkit.protocols.internet.internet.Internet" title="pcapkit.protocols.internet.internet.Internet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Internet</span></code></a>
subclasses)</p></td>
<td rowspan="10"><p>IP Family</p></td>
<td colspan="3"><p><a class="reference internal" href="pcapkit/protocols/internet/ip.html#pcapkit.protocols.internet.ip.IP" title="pcapkit.protocols.internet.ip.IP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.internet.ip.IP</span></code></a></p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p><a class="reference internal" href="pcapkit/protocols/internet/ipv4.html#pcapkit.protocols.internet.ipv4.IPv4" title="pcapkit.protocols.internet.ipv4.IPv4"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.internet.ipv4.IPv4</span></code></a></p></td>
</tr>
<tr class="row-even"><td colspan="3"><p><a class="reference internal" href="pcapkit/protocols/internet/ipv6.html#pcapkit.protocols.internet.ipv6.IPv6" title="pcapkit.protocols.internet.ipv6.IPv6"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.internet.ipv6.IPv6</span></code></a></p></td>
</tr>
<tr class="row-odd"><td colspan="2" rowspan="5"><p>IPv6 Extension Header</p></td>
<td><p><a class="reference internal" href="pcapkit/protocols/internet/ipv6_frag.html#pcapkit.protocols.internet.ipv6_frag.IPv6_Frag" title="pcapkit.protocols.internet.ipv6_frag.IPv6_Frag"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.internet.ipv6_frag.IPv6_Frag</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pcapkit/protocols/internet/ipv6_opts.html#pcapkit.protocols.internet.ipv6_opts.IPv6_Opts" title="pcapkit.protocols.internet.ipv6_opts.IPv6_Opts"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.internet.ipv6_opts.IPv6_Opts</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/protocols/internet/ipv6_route.html#pcapkit.protocols.internet.ipv6_route.IPv6_Route" title="pcapkit.protocols.internet.ipv6_route.IPv6_Route"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.internet.ipv6_route.IPv6_Route</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pcapkit/protocols/internet/hopopt.html#pcapkit.protocols.internet.hopopt.HOPOPT" title="pcapkit.protocols.internet.hopopt.HOPOPT"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.internet.hopopt.HOPOPT</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/protocols/internet/mh.html#pcapkit.protocols.internet.mh.MH" title="pcapkit.protocols.internet.mh.MH"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.internet.mh.MH</span></code></a></p></td>
</tr>
<tr class="row-even"><td colspan="2" rowspan="2"><p>IPsec Family</p></td>
<td><p><a class="reference internal" href="pcapkit/protocols/internet/ipsec.html#pcapkit.protocols.internet.ipsec.IPsec" title="pcapkit.protocols.internet.ipsec.IPsec"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.internet.ipsec.IPsec</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/protocols/internet/ah.html#pcapkit.protocols.internet.ah.AH" title="pcapkit.protocols.internet.ah.AH"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.internet.ah.AH</span></code></a></p></td>
</tr>
<tr class="row-even"><td colspan="4"><p><a class="reference internal" href="pcapkit/protocols/internet/ipx.html#pcapkit.protocols.internet.ipx.IPX" title="pcapkit.protocols.internet.ipx.IPX"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.internet.ipx.IPX</span></code></a></p></td>
</tr>
<tr class="row-odd"><td colspan="4"><p><a class="reference internal" href="pcapkit/protocols/internet/hip.html#pcapkit.protocols.internet.hip.HIP" title="pcapkit.protocols.internet.hip.HIP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.internet.hip.HIP</span></code></a></p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>Transport Layer
(<a class="reference internal" href="pcapkit/protocols/transport/transport.html#pcapkit.protocols.transport.transport.Transport" title="pcapkit.protocols.transport.transport.Transport"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transport</span></code></a>
subclasses)</p></td>
<td colspan="4"><p><a class="reference internal" href="pcapkit/protocols/transport/tcp.html#pcapkit.protocols.transport.tcp.TCP" title="pcapkit.protocols.transport.tcp.TCP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.transport.tcp.TCP</span></code></a></p></td>
</tr>
<tr class="row-odd"><td colspan="4"><p><a class="reference internal" href="pcapkit/protocols/transport/udp.html#pcapkit.protocols.transport.udp.UDP" title="pcapkit.protocols.transport.udp.UDP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.transport.udp.UDP</span></code></a></p></td>
</tr>
<tr class="row-even"><td rowspan="5"><p>Application Layer
(<a class="reference internal" href="pcapkit/protocols/application/application.html#pcapkit.protocols.application.application.Application" title="pcapkit.protocols.application.application.Application"><code class="xref py py-class docutils literal notranslate"><span class="pre">Application</span></code></a>
subclasses)</p></td>
<td rowspan="2"><p>FTP Family</p></td>
<td colspan="3"><p><a class="reference internal" href="pcapkit/protocols/application/ftp.html#pcapkit.protocols.application.ftp.FTP" title="pcapkit.protocols.application.ftp.FTP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.application.ftp.FTP</span></code></a></p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p><a class="reference internal" href="pcapkit/protocols/application/ftp.html#pcapkit.protocols.application.ftp.FTP_DATA" title="pcapkit.protocols.application.ftp.FTP_DATA"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.application.ftp.FTP_DATA</span></code></a></p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p>HTTP Family</p></td>
<td colspan="3"><p><a class="reference internal" href="pcapkit/protocols/application/http.html#pcapkit.protocols.application.http.HTTP" title="pcapkit.protocols.application.http.HTTP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.application.http.HTTP</span></code></a></p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p><a class="reference internal" href="pcapkit/protocols/application/httpv1.html#pcapkit.protocols.application.httpv1.HTTP" title="pcapkit.protocols.application.httpv1.HTTP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.application.httpv1.HTTP</span></code></a></p></td>
</tr>
<tr class="row-even"><td colspan="3"><p><a class="reference internal" href="pcapkit/protocols/application/httpv2.html#pcapkit.protocols.application.httpv2.HTTP" title="pcapkit.protocols.application.httpv2.HTTP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.application.httpv2.HTTP</span></code></a></p></td>
</tr>
<tr class="row-odd"><td rowspan="5"><p>Miscellaneous Protocols</p></td>
<td rowspan="2"><p>PCAP Format</p></td>
<td colspan="3"><p><a class="reference internal" href="pcapkit/protocols/misc/pcap.html#pcapkit.protocols.misc.pcap.header.Header" title="pcapkit.protocols.misc.pcap.header.Header"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.misc.pcap.header.Header</span></code></a></p></td>
</tr>
<tr class="row-even"><td colspan="3"><p><a class="reference internal" href="pcapkit/protocols/misc/pcap.html#pcapkit.protocols.misc.pcap.frame.Frame" title="pcapkit.protocols.misc.pcap.frame.Frame"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.misc.pcap.frame.Frame</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>PCAP-NG Format</p></td>
<td colspan="3"><p><a class="reference internal" href="pcapkit/protocols/misc/pcapng.html#pcapkit.protocols.misc.pcapng.PCAPNG" title="pcapkit.protocols.misc.pcapng.PCAPNG"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.misc.pcapng.PCAPNG</span></code></a></p></td>
</tr>
<tr class="row-even"><td colspan="4"><p><a class="reference internal" href="pcapkit/protocols/misc/raw.html#pcapkit.protocols.misc.raw.Raw" title="pcapkit.protocols.misc.raw.Raw"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.misc.raw.Raw</span></code></a></p></td>
</tr>
<tr class="row-odd"><td colspan="4"><p><a class="reference internal" href="pcapkit/protocols/misc/null.html#pcapkit.protocols.misc.null.NoPayload" title="pcapkit.protocols.misc.null.NoPayload"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.protocols.misc.null.NoPayload</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
<section id="new-protocol">
<h3>New Protocol<a class="headerlink" href="#new-protocol" title="Link to this heading">¶</a></h3>
<p>To add a new protocol, you need to create a new class inherited from
<a class="reference internal" href="pcapkit/protocols/protocol.html#pcapkit.protocols.protocol.Protocol" title="pcapkit.protocols.protocol.Protocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></a>, or its subclasses, specifically,
the <a class="reference internal" href="pcapkit/protocols/link/link.html#pcapkit.protocols.link.link.Link" title="pcapkit.protocols.link.link.Link"><code class="xref py py-class docutils literal notranslate"><span class="pre">Link</span></code></a>,
<a class="reference internal" href="pcapkit/protocols/internet/internet.html#pcapkit.protocols.internet.internet.Internet" title="pcapkit.protocols.internet.internet.Internet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Internet</span></code></a>,
<a class="reference internal" href="pcapkit/protocols/transport/transport.html#pcapkit.protocols.transport.transport.Transport" title="pcapkit.protocols.transport.transport.Transport"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transport</span></code></a>, and
<a class="reference internal" href="pcapkit/protocols/application/application.html#pcapkit.protocols.application.application.Application" title="pcapkit.protocols.application.application.Application"><code class="xref py py-class docutils literal notranslate"><span class="pre">Application</span></code></a> classes, which
are the base classes for link, internet, transport, and application layer
protocols, respectively.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The <a class="reference internal" href="pcapkit/protocols/protocol.html#pcapkit.protocols.protocol.Protocol" title="pcapkit.protocols.protocol.Protocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></a> class is the base class
for all protocols, and it is not recommended to inherit from it directly,
unless you are going to create a new protocol stack, e.g., a new
miscellaneous protocol stack as in <a class="reference internal" href="pcapkit/protocols/misc/index.html#module-pcapkit.protocols.misc" title="pcapkit.protocols.misc"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.protocols.misc</span></code></a> module.</p>
</div>
<p>Besides, you need to implement the corresponding schema and data model for the
new protocol. The schema is a <a class="reference internal" href="pcapkit/protocols/index.html#pcapkit.protocols.schema.schema.Schema" title="pcapkit.protocols.schema.schema.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a>
subclass that defines the field structure of the protocol, and the data model
is a <a class="reference internal" href="pcapkit/protocols/index.html#pcapkit.protocols.data.data.Data" title="pcapkit.protocols.data.data.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> subclass that defines the data
attributes of the protocol.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The schema classes are used for parsing and/or constructing the protocol
packets, each field should be defined as a class attribute with the value of
a <a class="reference internal" href="pcapkit/corekit/fields/field.html#pcapkit.corekit.fields.field.Field" title="pcapkit.corekit.fields.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> subclass instance.</p>
<p>The data classes are used for storing the parsed protocol packets. Each data
attribute should be defined as a class attribute with no value besides the
type annotations of the corresponding field.</p>
</div>
<p>Once the protocol class is implemented, you need to register it to the protocol
registry, which is managed by the APIs provided by
<a class="reference internal" href="pcapkit/foundation/registry.html#module-pcapkit.foundation.registry.protocols" title="pcapkit.foundation.registry.protocols"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.foundation.registry.protocols</span></code></a> module. Depending on the protocol
type, you need to register the protocol class to the corresponding registry, e.g.,
for a link layer protocol, you need to register it to the link layer protocol
registry thru <a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_linktype" title="pcapkit.foundation.registry.protocols.register_linktype"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_linktype()</span></code></a>
function.</p>
<p>The following table shows the type of protocols and the corresponding registry
functions:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Protocol Type</p></th>
<th class="head" colspan="2"><p>Registry Function</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="2"><p>Link Layer</p></td>
<td rowspan="2"><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_linktype" title="pcapkit.foundation.registry.protocols.register_linktype"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_linktype()</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_pcap" title="pcapkit.foundation.registry.protocols.register_pcap"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_pcap()</span></code></a></p></td>
<td rowspan="6"><p>Registry functions
on the left column
are combined calls
to those on the
right columns.</p>
<p>It is recommended
to use those on
the left columns
when registering
new protocols.</p>
</td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_pcapng" title="pcapkit.foundation.registry.protocols.register_pcapng"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_pcapng()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>Internet Layer</p></td>
<td colspan="2"><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_ethertype" title="pcapkit.foundation.registry.protocols.register_ethertype"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_ethertype()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>Transport Layer</p></td>
<td colspan="2"><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_transtype" title="pcapkit.foundation.registry.protocols.register_transtype"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_transtype()</span></code></a></p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>Application Layer</p></td>
<td rowspan="2"><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_apptype" title="pcapkit.foundation.registry.protocols.register_apptype"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_apptype()</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_tcp" title="pcapkit.foundation.registry.protocols.register_tcp"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_tcp()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_udp" title="pcapkit.foundation.registry.protocols.register_udp"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_udp()</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
<section id="samples">
<h4>Samples<a class="headerlink" href="#samples" title="Link to this heading">¶</a></h4>
<p>The following code snippet shows how to create a new protocol class:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Following is a PoC implementation of a new internet layer protocol. For
demonstration purpose, we use the IPv4 protocol as an example, where the
comprehensive implementation can be found in the
<a class="reference internal" href="pcapkit/protocols/internet/ipv4.html#module-pcapkit.protocols.internet.ipv4" title="pcapkit.protocols.internet.ipv4"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.protocols.internet.ipv4</span></code></a> module.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.protocols.internet.internet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Internet</span>  <span class="c1"># import base class</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.protocols.data.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Data</span>  <span class="c1"># import data class</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.protocols.schema.schema</span><span class="w"> </span><span class="kn">import</span> <span class="n">Schema</span>  <span class="c1"># import schema class</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.corekit.fields.ipaddress</span><span class="w"> </span><span class="kn">import</span> <span class="n">IPv4AddressField</span>  <span class="c1"># import field class</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.const.reg.ethertype</span><span class="w"> </span><span class="kn">import</span> <span class="n">EtherType</span>  <span class="c1"># import protocol code registry</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.foundation.registry.protocols</span><span class="w"> </span><span class="kn">import</span> <span class="n">register_ethertype</span>  <span class="c1"># import protocol registry API</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">ipaddress</span><span class="w"> </span><span class="kn">import</span> <span class="n">IPv4Address</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>


<span class="k">class</span><span class="w"> </span><span class="nc">IPv4Data</span><span class="p">(</span><span class="n">Data</span><span class="p">):</span>  <span class="c1"># define data model</span>

    <span class="o">...</span>
    <span class="n">src</span><span class="p">:</span> <span class="s1">&#39;IPv4Address&#39;</span>  <span class="c1"># source address</span>
    <span class="n">dst</span><span class="p">:</span> <span class="s1">&#39;IPv4Address&#39;</span>  <span class="c1"># destination address</span>
    <span class="o">...</span>


<span class="k">class</span><span class="w"> </span><span class="nc">IPv4Schema</span><span class="p">(</span><span class="n">Schema</span><span class="p">):</span>  <span class="c1"># define fields</span>

    <span class="o">...</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">IPv4AddressField</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="n">dst</span> <span class="o">=</span> <span class="n">IPv4AddressField</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="o">...</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MyIPv4</span><span class="p">(</span><span class="n">Internet</span><span class="p">[</span><span class="n">IPv4Data</span><span class="p">,</span> <span class="n">IPv4Schema</span><span class="p">],</span>
             <span class="n">schema</span><span class="o">=</span><span class="n">IPv4Schema</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">IPv4Data</span><span class="p">):</span>  <span class="c1"># define protocol class</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="s1">&#39;Optional[int]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;IPv4Data&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># infer length of packet from data</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__header__</span>  <span class="c1"># get schema</span>

        <span class="k">return</span> <span class="n">IPv4Data</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;IPv4Schema&#39;</span><span class="p">:</span>
        <span class="o">...</span>

        <span class="k">return</span> <span class="n">IPv4Schema</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>


<span class="c1"># register protocol class</span>
<span class="n">register_ethertype</span><span class="p">(</span><span class="n">EtherType</span><span class="o">.</span><span class="n">Internet_Protocol_version_4</span><span class="p">,</span> <span class="n">MyIPv4</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="extending-existing-protocol">
<h3>Extending Existing Protocol<a class="headerlink" href="#extending-existing-protocol" title="Link to this heading">¶</a></h3>
<p>In many cases, existing protocols have customisable attributes, e.g., the
option headers in the IPv4 protocol. To extend an existing protocol with
additional methods for handling option headers, and etc., you need to first
redirect to the corresponding protocol class, and check if the protocol class
supports the expected extension. If so, you can add the extension methods to
the protocol class, as it may be discussed in the protocol documentation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is not recommended to directly inherit from the protocol class, as it
may cause unexpected errors. Instead, you should use the provided helper
functions to extend the protocol class.</p>
<p>See <a class="reference internal" href="pcapkit/foundation/registry.html#module-pcapkit.foundation.registry.protocols" title="pcapkit.foundation.registry.protocols"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.foundation.registry.protocols</span></code></a> module for available
helper registry functions and the corresponding protocol classes.</p>
</div>
<p>The following table shows the protocol classes with their corresponding
available extensible items and the helper registry functions:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Protocol Type</p></th>
<th class="head"><p>Protocol Class</p></th>
<th class="head"><p>Extensable Registry</p></th>
<th class="head"><p>Registry Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="10"><p>Internet Layer</p></td>
<td rowspan="2"><p><a class="reference internal" href="pcapkit/protocols/internet/ipv4.html#pcapkit.protocols.internet.ipv4.IPv4" title="pcapkit.protocols.internet.ipv4.IPv4"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPv4</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/protocols/internet/ipv4.html#pcapkit.protocols.internet.ipv4.IPv4._read_opt_unassigned" title="pcapkit.protocols.internet.ipv4.IPv4._read_opt_unassigned"><code class="xref py py-func docutils literal notranslate"><span class="pre">IPv4._read_opt_${name}</span></code></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_ipv4_option" title="pcapkit.foundation.registry.protocols.register_ipv4_option"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_ipv4_option()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/protocols/internet/ipv4.html#pcapkit.protocols.internet.ipv4.IPv4._make_opt_unassigned" title="pcapkit.protocols.internet.ipv4.IPv4._make_opt_unassigned"><code class="xref py py-func docutils literal notranslate"><span class="pre">IPv4._make_opt_${name}</span></code></a></p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p><a class="reference internal" href="pcapkit/protocols/internet/hip.html#pcapkit.protocols.internet.hip.HIP" title="pcapkit.protocols.internet.hip.HIP"><code class="xref py py-class docutils literal notranslate"><span class="pre">HIP</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/protocols/internet/hip.html#pcapkit.protocols.internet.hip.HIP._read_param_unassigned" title="pcapkit.protocols.internet.hip.HIP._read_param_unassigned"><code class="xref py py-func docutils literal notranslate"><span class="pre">HIP._read_param_${name}</span></code></a></p></td>
<td rowspan="2"><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_hip_parameter" title="pcapkit.foundation.registry.protocols.register_hip_parameter"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_hip_parameter()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/protocols/internet/hip.html#pcapkit.protocols.internet.hip.HIP._make_param_unassigned" title="pcapkit.protocols.internet.hip.HIP._make_param_unassigned"><code class="xref py py-func docutils literal notranslate"><span class="pre">HIP._make_param_${name}</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pcapkit/protocols/internet/hopopt.html#pcapkit.protocols.internet.hopopt.HOPOPT" title="pcapkit.protocols.internet.hopopt.HOPOPT"><code class="xref py py-class docutils literal notranslate"><span class="pre">HOPOPT</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/protocols/internet/hopopt.html#pcapkit.protocols.internet.hopopt.HOPOPT.__option__" title="pcapkit.protocols.internet.hopopt.HOPOPT.__option__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HOPOPT.__option__</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_hopopt_option" title="pcapkit.foundation.registry.protocols.register_hopopt_option"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_hopopt_option()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/protocols/internet/ipv6_opts.html#pcapkit.protocols.internet.ipv6_opts.IPv6_Opts" title="pcapkit.protocols.internet.ipv6_opts.IPv6_Opts"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPv6_Opts</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/protocols/internet/ipv6_opts.html#pcapkit.protocols.internet.ipv6_opts.IPv6_Opts.__option__" title="pcapkit.protocols.internet.ipv6_opts.IPv6_Opts.__option__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">IPv6_Opts.__option__</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_ipv6_opts_option" title="pcapkit.foundation.registry.protocols.register_ipv6_opts_option"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_ipv6_opts_option()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pcapkit/protocols/internet/ipv6_route.html#pcapkit.protocols.internet.ipv6_route.IPv6_Route" title="pcapkit.protocols.internet.ipv6_route.IPv6_Route"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPv6_Route</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/protocols/internet/ipv6_route.html#pcapkit.protocols.internet.ipv6_route.IPv6_Route.__routing__" title="pcapkit.protocols.internet.ipv6_route.IPv6_Route.__routing__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">IPv6_Route.__routing__</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_ipv6_route_routing" title="pcapkit.foundation.registry.protocols.register_ipv6_route_routing"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_ipv6_route_routing()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td rowspan="3"><p><a class="reference internal" href="pcapkit/protocols/internet/mh.html#pcapkit.protocols.internet.mh.MH" title="pcapkit.protocols.internet.mh.MH"><code class="xref py py-class docutils literal notranslate"><span class="pre">MH</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/protocols/internet/mh.html#pcapkit.protocols.internet.mh.MH.__message__" title="pcapkit.protocols.internet.mh.MH.__message__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MH.__message__</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_mh_message" title="pcapkit.foundation.registry.protocols.register_mh_message"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_mh_message()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pcapkit/protocols/internet/mh.html#pcapkit.protocols.internet.mh.MH.__option__" title="pcapkit.protocols.internet.mh.MH.__option__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MH.__option__</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_mh_option" title="pcapkit.foundation.registry.protocols.register_mh_option"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_mh_option()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/protocols/internet/mh.html#pcapkit.protocols.internet.mh.MH.__extension__" title="pcapkit.protocols.internet.mh.MH.__extension__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MH.__extension__</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_mh_extension" title="pcapkit.foundation.registry.protocols.register_mh_extension"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_mh_extension()</span></code></a></p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>Transport Layer</p></td>
<td rowspan="2"><p><a class="reference internal" href="pcapkit/protocols/transport/tcp.html#pcapkit.protocols.transport.tcp.TCP" title="pcapkit.protocols.transport.tcp.TCP"><code class="xref py py-class docutils literal notranslate"><span class="pre">TCP</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/protocols/transport/tcp.html#pcapkit.protocols.transport.tcp.TCP.__option__" title="pcapkit.protocols.transport.tcp.TCP.__option__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TCP.__option__</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_tcp_option" title="pcapkit.foundation.registry.protocols.register_tcp_option"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_tcp_option()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/protocols/transport/tcp.html#pcapkit.protocols.transport.tcp.TCP.__mp_option__" title="pcapkit.protocols.transport.tcp.TCP.__mp_option__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TCP.__mp_option__</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_tcp_mp_option" title="pcapkit.foundation.registry.protocols.register_tcp_mp_option"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_tcp_mp_option()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>Application Layer</p></td>
<td><p><a class="reference internal" href="pcapkit/protocols/application/httpv2.html#pcapkit.protocols.application.httpv2.HTTP" title="pcapkit.protocols.application.httpv2.HTTP"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTTP</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/protocols/application/httpv2.html#pcapkit.protocols.application.httpv2.HTTP.__frame__" title="pcapkit.protocols.application.httpv2.HTTP.__frame__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HTTP.__frame__</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_http_frame" title="pcapkit.foundation.registry.protocols.register_http_frame"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_http_frame()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td rowspan="4"><p>Miscellaneous
Protocols</p></td>
<td rowspan="4"><p><a class="reference internal" href="pcapkit/protocols/misc/pcapng.html#pcapkit.protocols.misc.pcapng.PCAPNG" title="pcapkit.protocols.misc.pcapng.PCAPNG"><code class="xref py py-class docutils literal notranslate"><span class="pre">PCAPNG</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/protocols/misc/pcapng.html#pcapkit.protocols.misc.pcapng.PCAPNG.__block__" title="pcapkit.protocols.misc.pcapng.PCAPNG.__block__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PCAPNG.__block__</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_pcapng_block" title="pcapkit.foundation.registry.protocols.register_pcapng_block"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_pcapng_block()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pcapkit/protocols/misc/pcapng.html#pcapkit.protocols.misc.pcapng.PCAPNG.__option__" title="pcapkit.protocols.misc.pcapng.PCAPNG.__option__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PCAPNG.__option__</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_pcapng_option" title="pcapkit.foundation.registry.protocols.register_pcapng_option"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_pcapng_option()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/protocols/misc/pcapng.html#pcapkit.protocols.misc.pcapng.PCAPNG.__record__" title="pcapkit.protocols.misc.pcapng.PCAPNG.__record__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PCAPNG.__record__</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_pcapng_record" title="pcapkit.foundation.registry.protocols.register_pcapng_record"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_pcapng_record()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pcapkit/protocols/misc/pcapng.html#pcapkit.protocols.misc.pcapng.PCAPNG.__secrets__" title="pcapkit.protocols.misc.pcapng.PCAPNG.__secrets__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PCAPNG.__secrets__</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.protocols.register_pcapng_secrets" title="pcapkit.foundation.registry.protocols.register_pcapng_secrets"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_pcapng_secrets()</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>All extensable items are to be implemented as class methods, whose first argument
is the protocol class itself, and the rest arguments are the same as the other
built-in methods’ signatures.</p>
</div>
</section>
</section>
<section id="and-speaking-of-library-foundations">
<h2>And Speaking of Library Foundations…<a class="headerlink" href="#and-speaking-of-library-foundations" title="Link to this heading">¶</a></h2>
<p>The <a class="reference internal" href="pcapkit/index.html#module-pcapkit" title="pcapkit"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit</span></code></a> library is built on top of the <a class="reference internal" href="pcapkit/foundation/index.html#module-pcapkit.foundation" title="pcapkit.foundation"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.foundation</span></code></a>
module, which provides the basic functionalities for the library. The
<a class="reference internal" href="pcapkit/foundation/index.html#module-pcapkit.foundation" title="pcapkit.foundation"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.foundation</span></code></a> module is designed to be extensible, and it is
easy to add new features to the library.</p>
<section id="extractor-engines">
<h3>Extractor Engines<a class="headerlink" href="#extractor-engines" title="Link to this heading">¶</a></h3>
<p>The <a class="reference internal" href="pcapkit/foundation/engines/index.html#module-pcapkit.foundation.engines" title="pcapkit.foundation.engines"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.foundation.engines</span></code></a> module provides several built-in engines
for extracting network packets from the intput PCAP and/or PCAP-NG, etc., files.
All engines are implemented as <a class="reference internal" href="pcapkit/foundation/engines/engine.html#pcapkit.foundation.engines.engine.Engine" title="pcapkit.foundation.engines.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>
subclasses, which are responsible for parsing the input files and extracting
the network packets for further processing.</p>
<p>The following table shows the available engines and the corresponding supported
file formats:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Engine Type</p></th>
<th class="head"><p>Engine Class</p></th>
<th class="head"><p>Supported File Formats</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="2"><p>Built-in Engines</p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/engines/builtin.html#pcapkit.foundation.engines.pcap.PCAP" title="pcapkit.foundation.engines.pcap.PCAP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.foundation.engines.pcap.PCAP</span></code></a></p></td>
<td><p>PCAP only</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/foundation/engines/builtin.html#pcapkit.foundation.engines.pcapng.PCAPNG" title="pcapkit.foundation.engines.pcapng.PCAPNG"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.foundation.engines.pcapng.PCAPNG</span></code></a></p></td>
<td><p>PCAP-NG only</p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p>Third-party Engines</p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/engines/3rdparty.html#pcapkit.foundation.engines.scapy.Scapy" title="pcapkit.foundation.engines.scapy.Scapy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.foundation.engines.scapy.Scapy</span></code></a></p></td>
<td><p>all formats supported by <a class="reference external" href="https://scapy.net">Scapy</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/foundation/engines/3rdparty.html#pcapkit.foundation.engines.dpkt.DPKT" title="pcapkit.foundation.engines.dpkt.DPKT"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.foundation.engines.dpkt.DPKT</span></code></a></p></td>
<td><p>all formats supported by <a class="reference external" href="https://dpkt.readthedocs.io">DPKT</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pcapkit/foundation/engines/3rdparty.html#pcapkit.foundation.engines.pyshark.PyShark" title="pcapkit.foundation.engines.pyshark.PyShark"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.foundation.engines.pyshark.PyShark</span></code></a></p></td>
<td><p>all formats supported by <a class="reference external" href="https://kiminewt.github.io/pyshark">PyShark</a></p></td>
</tr>
</tbody>
</table>
</div>
<section id="id1">
<h4>Samples<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<p>The following code snippet shows how to create a new engine class:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Following is a PoC implementation of a new engine based on <a class="reference external" href="https://scapy.readthedocs.io/en/latest/api/scapy.html#module-scapy" title="(in Scapy v2.6.1.dev146)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scapy</span></code></a>. For documentation
purposes, we use the <a class="reference internal" href="pcapkit/foundation/engines/3rdparty.html#pcapkit.foundation.engines.scapy.Scapy" title="pcapkit.foundation.engines.scapy.Scapy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scapy</span></code></a> engine as an example,
where the comprehensive implementation can be found in the <a class="reference internal" href="pcapkit/foundation/engines/3rdparty.html#module-pcapkit.foundation.engines.scapy" title="pcapkit.foundation.engines.scapy"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.foundation.engines.scapy</span></code></a>
module.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.foundation.engines.engine</span><span class="w"> </span><span class="kn">import</span> <span class="n">Engine</span>  <span class="c1"># import base class</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.foundation.extraction</span><span class="w"> </span><span class="kn">import</span> <span class="n">Extractor</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">scapy.packet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Packet</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MyScapy</span><span class="p">(</span><span class="n">Engine</span><span class="p">[</span><span class="s1">&#39;Packet&#39;</span><span class="p">]):</span>

    <span class="n">__engine_name__</span> <span class="o">=</span> <span class="s1">&#39;Scapy&#39;</span>  <span class="c1"># friendly name of the engine</span>
    <span class="n">__engine_module__</span> <span class="o">=</span> <span class="s1">&#39;scapy&#39;</span>  <span class="c1"># module name that the engine is based on</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extractor</span><span class="p">:</span> <span class="s1">&#39;Extractor&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
        <span class="c1"># NOTE: the API entry point of the underlying engine module should</span>
        <span class="c1"># be imported here, instead of at the top of the module, to avoid</span>
        <span class="c1"># dependency issues.</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">scapy</span><span class="w"> </span><span class="kn">import</span> <span class="n">sendrecv</span>  <span class="c1"># import API entry point</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_expkg</span> <span class="o">=</span> <span class="n">sendrecv</span>  <span class="c1"># store API entry point</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extmp</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># intermediate storage for the interator</span>
                            <span class="c1"># generated by the API entry point</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">extractor</span><span class="p">)</span>  <span class="c1"># initialise base class</span>

    <span class="c1"># NOTE: The following methods are the core methods of the engine class,</span>
    <span class="c1"># which are responsible for parsing the input file and extracting the</span>
    <span class="c1"># network packets for further processing. It is expected to create an</span>
    <span class="c1"># iterator instance that yields the network packets, and store it in</span>
    <span class="c1"># the intermediate storage, i.e., self._extmp for further processing,</span>
    <span class="c1"># using the API entry point as in the self._expkg attribute.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extractor</span>  <span class="c1"># get extractor instance</span>

        <span class="c1"># NOTE: You may wish to do some pre-processing here, e.g., to</span>
        <span class="c1"># check if there&#39;s any extraction protocol and/or layer thresholds</span>
        <span class="c1"># set by the user (some engines may not support this feature); or</span>
        <span class="c1"># to set up the verbose handler for the underlying engine module,</span>
        <span class="c1"># as in the following code snippet.</span>

        <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">_flag_v</span><span class="p">:</span>  <span class="c1"># check if verbose mode is enabled</span>
            <span class="c1"># NOTE: PyPCAPKit has its own bundled supporting functions for</span>
            <span class="c1"># third-party libraries, e.g., the `packet2chain` function is</span>
            <span class="c1"># to convert a given Packet instance of the Scapy library to a</span>
            <span class="c1"># human-readable string, which is used for verbose output.</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.toolkit.scapy</span><span class="w"> </span><span class="kn">import</span> <span class="n">pack2chain</span>  <span class="c1"># import utility function</span>

            <span class="n">ext</span><span class="o">.</span><span class="n">_vfunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">extractor</span><span class="p">,</span> <span class="n">packet</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Frame </span><span class="si">{</span><span class="n">extractor</span><span class="o">.</span><span class="n">_frnum</span><span class="si">:</span><span class="s1">&gt;3d</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">pack2chain</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="p">)</span>  <span class="c1"># print verbose message as `Frame XXX: Ethernet:IP:TCP:...`</span>

        <span class="c1"># NOTE: Here we use the API entry point, i.e., scapy.sendrecv.sniff,</span>
        <span class="c1"># to read the input file and extract the network packets. The API</span>
        <span class="c1"># entry point returns an iterable instance, which is then converted</span>
        <span class="c1"># as an iterator and stored in the intermediate storage for further</span>
        <span class="c1"># processing.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extmp</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_expkg</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="n">offline</span><span class="o">=</span><span class="n">ext</span><span class="o">.</span><span class="n">_ifnm</span><span class="p">))</span>

    <span class="c1"># NOTE: The following methods are the helper methods of the engine class,</span>
    <span class="c1"># which are responsible for extracting the network packets from the</span>
    <span class="c1"># intermediate storage, i.e., self._extmp, and returning the extracted</span>
    <span class="c1"># network packets for further processing. It is also expected to handle</span>
    <span class="c1"># necessary actions, including but not limited to, verbose output, file</span>
    <span class="c1"># output, reassembly and flow tracing, etc.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">read_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Packet&#39;</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.toolkit.scapy</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">ipv4_reassembly</span><span class="p">,</span> <span class="n">ipv6_reassembly</span><span class="p">,</span> <span class="n">packet2dict</span><span class="p">,</span>
                                           <span class="n">tcp_reassembly</span><span class="p">,</span> <span class="n">tcp_traceflow</span><span class="p">)</span>  <span class="c1"># import utility functions</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extractor</span>  <span class="c1"># get extractor instance</span>

        <span class="n">packet</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extmp</span><span class="p">)</span>  <span class="c1"># get next packet from the iterator</span>

        <span class="n">ext</span><span class="o">.</span><span class="n">_frnum</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># increment frame number</span>
        <span class="n">ext</span><span class="o">.</span><span class="n">_vfunc</span><span class="p">(</span><span class="n">ext</span><span class="p">,</span> <span class="n">packet</span><span class="p">)</span>  <span class="c1"># print verbose message</span>

        <span class="c1"># NOTE: The following code snippet is to handle the file output,</span>
        <span class="c1"># i.e., to write the packet to the output file if the output file</span>
        <span class="c1"># is specified by the user.</span>
        <span class="n">frnum</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Frame </span><span class="si">{</span><span class="n">ext</span><span class="o">.</span><span class="n">_frnum</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ext</span><span class="o">.</span><span class="n">_flag_q</span><span class="p">:</span>
            <span class="n">info</span> <span class="o">=</span> <span class="n">packet2dict</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span>  <span class="c1"># convert packet to dict-like object</span>

            <span class="c1"># NOTE: Now, we need to check if output file is to be a single</span>
            <span class="c1"># file. If so, we can directly write the packet to the output</span>
            <span class="c1"># file, i.e., ext._ofile; otherwise, we need to create a new</span>
            <span class="c1"># dumper instance by initialising ext._ofile, and write the</span>
            <span class="c1"># packet to the dumper instance. For more information, please</span>
            <span class="c1"># refer to the documentation of DictDumper library.</span>
            <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">_flag_f</span><span class="p">:</span>
                <span class="n">ofile</span> <span class="o">=</span> <span class="n">ext</span><span class="o">.</span><span class="n">_ofile</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ext</span><span class="o">.</span><span class="n">_ofnm</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">frnum</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">ext</span><span class="o">.</span><span class="n">_fext</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">ofile</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">frnum</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ext</span><span class="o">.</span><span class="n">_ofile</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">frnum</span><span class="p">)</span>

        <span class="c1"># NOTE: The following code snippet is to handle the reassembly of</span>
        <span class="c1"># the network packets, i.e., to reassemble the fragmented packets</span>
        <span class="c1"># into a complete packet. Before reassembly, we need to convert</span>
        <span class="c1"># the packet to a tailored format, i.e., a dict-like object, which</span>
        <span class="c1"># is then passed to the reassembly function. For more information,</span>
        <span class="c1"># please refer to the documentation of pcapkit.foundation.reassembly</span>
        <span class="c1"># module.</span>
        <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">_flag_r</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">_ipv4</span><span class="p">:</span>
                <span class="n">data_ipv4</span> <span class="o">=</span> <span class="n">ipv4_reassembly</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">ext</span><span class="o">.</span><span class="n">_frnum</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">data_ipv4</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ext</span><span class="o">.</span><span class="n">_reasm</span><span class="o">.</span><span class="n">ipv4</span><span class="p">(</span><span class="n">data_ipv4</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">_ipv6</span><span class="p">:</span>
                <span class="n">data_ipv6</span> <span class="o">=</span> <span class="n">ipv6_reassembly</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">ext</span><span class="o">.</span><span class="n">_frnum</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">data_ipv6</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ext</span><span class="o">.</span><span class="n">_reasm</span><span class="o">.</span><span class="n">ipv6</span><span class="p">(</span><span class="n">data_ipv6</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">_tcp</span><span class="p">:</span>
                <span class="n">data_tcp</span> <span class="o">=</span> <span class="n">tcp_reassembly</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">ext</span><span class="o">.</span><span class="n">_frnum</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">data_tcp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ext</span><span class="o">.</span><span class="n">_reasm</span><span class="o">.</span><span class="n">tcp</span><span class="p">(</span><span class="n">data_tcp</span><span class="p">)</span>

        <span class="c1"># NOTE: The following code snippet is to handle the flow tracing of</span>
        <span class="c1"># the network packets, i.e., to trace a series of packets as they</span>
        <span class="c1"># will compose as a flow and/or stream. Before reassembly, we need</span>
        <span class="c1"># to convert the packet to a tailored format, i.e., a dict-like object,</span>
        <span class="c1"># which is then passed to the flow tracing function. For more</span>
        <span class="c1"># information, please refer to the documentation of</span>
        <span class="c1"># pcapkit.foundation.traceflow module.</span>
        <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">_flag_t</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">_tcp</span><span class="p">:</span>
                <span class="n">data_tf_tcp</span> <span class="o">=</span> <span class="n">tcp_traceflow</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">ext</span><span class="o">.</span><span class="n">_frnum</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">data_tf_tcp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ext</span><span class="o">.</span><span class="n">_trace</span><span class="o">.</span><span class="n">tcp</span><span class="p">(</span><span class="n">data_tf_tcp</span><span class="p">)</span>

        <span class="c1"># NOTE: The following code snippet is to record extracted frames</span>
        <span class="c1"># into the internal storage, i.e., ext._frame, for further processing.</span>
        <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">_flag_d</span><span class="p">:</span>
            <span class="n">ext</span><span class="o">.</span><span class="n">_frame</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">packet</span>  <span class="c1"># return the extracted packet</span>
</pre></div>
</div>
</section>
</section>
<section id="output-dumpers">
<h3>Output Dumpers<a class="headerlink" href="#output-dumpers" title="Link to this heading">¶</a></h3>
<p>The <a class="reference internal" href="pcapkit/dumpkit/index.html#module-pcapkit.dumpkit" title="pcapkit.dumpkit"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.dumpkit</span></code></a> module wraps the <a class="reference external" href="https://dictdumper.jarryshaw.me/en/latest/dictdumper.html#module-dictdumper" title="(in DictDumper)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">DictDumper</span></code></a>
library, which provides the basic functionalities for dumping the extracted
network packets to the output file. The <a class="reference internal" href="pcapkit/dumpkit/index.html#module-pcapkit.dumpkit" title="pcapkit.dumpkit"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.dumpkit</span></code></a> module is
designed to be extensible, and it is easy to add new output formats to the
library, based on the extensibility of the <a class="reference external" href="https://dictdumper.jarryshaw.me/en/latest/dictdumper.html#module-dictdumper" title="(in DictDumper)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">DictDumper</span></code></a>
library.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to the documentation of <a class="reference external" href="https://dictdumper.jarryshaw.me/en/latest/dictdumper.html#module-dictdumper" title="(in DictDumper)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">DictDumper</span></code></a> library
for more information about the output dumpers.</p>
</div>
<p>The following table shows the available output dumpers and the corresponding
formats:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Dumper Format</p></th>
<th class="head"><p>Dumper Class</p></th>
<th class="head"><p>Output Extension</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>No Output</em></p></td>
<td><p><a class="reference internal" href="pcapkit/dumpkit/null.html#pcapkit.dumpkit.null.NotImplementedIO" title="pcapkit.dumpkit.null.NotImplementedIO"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.dumpkit.null.NotImplementedIO</span></code></a></p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p>PCAP (<code class="docutils literal notranslate"><span class="pre">cap</span></code>/<code class="docutils literal notranslate"><span class="pre">pcap</span></code>)</p></td>
<td><p><a class="reference internal" href="pcapkit/dumpkit/pcap.html#pcapkit.dumpkit.pcap.PCAPIO" title="pcapkit.dumpkit.pcap.PCAPIO"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.dumpkit.pcap.PCAPIO</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.pcap</span></code></p></td>
</tr>
<tr class="row-even"><td><p>XML (<code class="docutils literal notranslate"><span class="pre">xml</span></code>/<code class="docutils literal notranslate"><span class="pre">plist</span></code>)</p></td>
<td><p><a class="reference external" href="https://dictdumper.jarryshaw.me/en/latest/dictdumper.plist.html#dictdumper.plist.PLIST" title="(in DictDumper)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dictdumper.plist.PLIST</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.plist</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>JSON (<code class="docutils literal notranslate"><span class="pre">json</span></code>)</p></td>
<td><p><a class="reference external" href="https://dictdumper.jarryshaw.me/en/latest/dictdumper.json.html#dictdumper.json.JSON" title="(in DictDumper)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dictdumper.json.JSON</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.json</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Text (<code class="docutils literal notranslate"><span class="pre">txt</span></code>/<code class="docutils literal notranslate"><span class="pre">text</span></code>/<code class="docutils literal notranslate"><span class="pre">tree</span></code>)</p></td>
<td><p><a class="reference external" href="https://dictdumper.jarryshaw.me/en/latest/dictdumper.tree.html#dictdumper.tree.Tree" title="(in DictDumper)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dictdumper.tree.Tree</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.txt</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<section id="id2">
<h4>Samples<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<p>The following code snippet shows how to create a new dumper class:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Following is a PoC implementation of a new dumper for the PCAP format. For
documentation purposes, we use the <a class="reference internal" href="pcapkit/dumpkit/pcap.html#pcapkit.dumpkit.pcap.PCAPIO" title="pcapkit.dumpkit.pcap.PCAPIO"><code class="xref py py-class docutils literal notranslate"><span class="pre">PCAPIO</span></code></a>
dumper as an example, where the comprehensive implementation can be found
in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.dumpkit.pcap</span></code> module.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.dumpkit.common</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dumper</span>  <span class="c1"># import base class</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.protocols.misc.pcap.header</span><span class="w"> </span><span class="kn">import</span> <span class="n">Header</span>  <span class="c1"># import PCAP header class</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.protocols.misc.pcap.frame</span><span class="w"> </span><span class="kn">import</span> <span class="n">Frame</span>  <span class="c1"># import PCAP frame class</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>


<span class="c1"># NOTE: We need to specify the output file format and extension here at the</span>
<span class="c1"># class definition, as in the following code snippet. Such that PyPCAPKit</span>
<span class="c1"># will be able to automatically register our dumper class to the corresponding</span>
<span class="c1"># dumper registries, and use it to dump the extracted network packets.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyDumper</span><span class="p">(</span><span class="n">Dumper</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;pcap&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;.pcap&#39;</span><span class="p">):</span>

    <span class="c1"># NOTE: This property is to define the file format of the dumper.</span>
    <span class="c1"># It is expected to be a string, which is used as the file extension</span>
    <span class="c1"># of the output file.</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">kind</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;pcap&#39;</span>

    <span class="c1"># NOTE: We need to collect some necessary information here thru the necessary</span>
    <span class="c1"># arguments, e.g., the file name, link-layer protocol, etc., which will be</span>
    <span class="c1"># used to generate the top-level header of the output file.</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
        <span class="c1"># NOTE: We can do some pre-processing here if necessary, e.g., to</span>
        <span class="c1"># save the nanosecond-resolution flag, link-layer protocol type, etc.,</span>
        <span class="c1"># such that we can use them later when dumping the network packets.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fnum</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># initialise frame number counter to 1</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>  <span class="c1"># initialise base class with the file name</span>
                                      <span class="c1"># and other necessary arguments</span>

    <span class="c1"># NOTE: We need to overwrite the original ``__call__`` method, cause the</span>
    <span class="c1"># PCAP file format is a binary format, thus we need to re-open the output</span>
    <span class="c1"># file in binary mode, instead of the default text mode.</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="s1">&#39;Frame&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Optional[str]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MyDumper&#39;</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="p">,</span> <span class="s1">&#39;ab&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_append_value</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">name</span> <span class="ow">or</span> <span class="sa">f</span><span class="s1">&#39;Frame </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_fnum</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># append value to the file</span>
         <span class="k">return</span> <span class="bp">self</span>

    <span class="c1"># NOTE: The following method will be called at the initialisation of the</span>
    <span class="c1"># dumper class, which is expected to write the top-level header of the</span>
    <span class="c1"># output file.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_dump_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
        <span class="n">packet</span> <span class="o">=</span> <span class="n">Header</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># create PCAP header instance based on the given arguments</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">packet</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># write the header to the output file</span>

    <span class="c1"># NOTE: The following method is to write the network packets to the output</span>
    <span class="c1"># file. It is expected to convert the network packet to a tailored format,</span>
    <span class="c1"># i.e., a Frame instance, which is then converted to the binary format and</span>
    <span class="c1"># written to the output file.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_append_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="s1">&#39;Frame&#39;</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="s1">&#39;IO[bytes]&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
        <span class="n">packet</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># create PCAP frame instance based on the given arguments</span>

        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">packet</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># write the frame to the output file</span>

        <span class="c1"># NOTE: We can do some post-processing here if necessary, e.g., to</span>
        <span class="c1"># update the frame number counter, etc., such that we can use them</span>
        <span class="c1"># later when dumping other network packets.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fnum</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># increment frame number counter</span>
</pre></div>
</div>
</section>
</section>
<section id="reassembly-and-flow-tracing">
<h3>Reassembly and Flow Tracing<a class="headerlink" href="#reassembly-and-flow-tracing" title="Link to this heading">¶</a></h3>
<p>The <a class="reference internal" href="pcapkit/foundation/reassembly/index.html#module-pcapkit.foundation.reassembly" title="pcapkit.foundation.reassembly"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.foundation.reassembly</span></code></a> module provides several built-in
reassembly classes for reassembling the fragmented network packets; and the
<a class="reference internal" href="pcapkit/foundation/traceflow/index.html#module-pcapkit.foundation.traceflow" title="pcapkit.foundation.traceflow"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.foundation.traceflow</span></code></a> module provides several built-in flow
tracing classes for tracing the network packets as they will compose as a
flow and/or stream. All reassembly and flow tracing classes are implemented
as <a class="reference internal" href="pcapkit/foundation/reassembly/reassembly.html#pcapkit.foundation.reassembly.reassembly.Reassembly" title="pcapkit.foundation.reassembly.reassembly.Reassembly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reassembly</span></code></a> and
<a class="reference internal" href="pcapkit/foundation/traceflow/traceflow.html#pcapkit.foundation.traceflow.traceflow.TraceFlow" title="pcapkit.foundation.traceflow.traceflow.TraceFlow"><code class="xref py py-class docutils literal notranslate"><span class="pre">TraceFlow</span></code></a> subclasses,
respectively, which are responsible for reassembling and tracing the network
packets for further processing.</p>
<p>The following table shows the available reassembly and flow tracing classes
per the supported protocols:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Protocol</p></th>
<th class="head"><p>Reassembly Class</p></th>
<th class="head"><p>Flow Tracing Class</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="pcapkit/protocols/internet/ipv4.html#pcapkit.protocols.internet.ipv4.IPv4" title="pcapkit.protocols.internet.ipv4.IPv4"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPv4</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/reassembly/ip/ipv4.html#pcapkit.foundation.reassembly.ipv4.IPv4" title="pcapkit.foundation.reassembly.ipv4.IPv4"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.foundation.reassembly.ipv4.IPv4</span></code></a></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="pcapkit/protocols/internet/ipv6.html#pcapkit.protocols.internet.ipv6.IPv6" title="pcapkit.protocols.internet.ipv6.IPv6"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPv6</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/reassembly/ip/ipv6.html#pcapkit.foundation.reassembly.ipv6.IPv6" title="pcapkit.foundation.reassembly.ipv6.IPv6"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.foundation.reassembly.ipv6.IPv6</span></code></a></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="pcapkit/protocols/transport/tcp.html#pcapkit.protocols.transport.tcp.TCP" title="pcapkit.protocols.transport.tcp.TCP"><code class="xref py py-class docutils literal notranslate"><span class="pre">TCP</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/reassembly/tcp.html#pcapkit.foundation.reassembly.tcp.TCP" title="pcapkit.foundation.reassembly.tcp.TCP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.foundation.reassembly.tcp.TCP</span></code></a></p></td>
<td><p><a class="reference internal" href="pcapkit/foundation/traceflow/tcp.html#pcapkit.foundation.traceflow.tcp.TCP" title="pcapkit.foundation.traceflow.tcp.TCP"><code class="xref py py-class docutils literal notranslate"><span class="pre">pcapkit.foundation.traceflow.tcp.TCP</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to the documentation of <a class="reference internal" href="pcapkit/foundation/reassembly/index.html#module-pcapkit.foundation.reassembly" title="pcapkit.foundation.reassembly"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.foundation.reassembly</span></code></a> and
<a class="reference internal" href="pcapkit/foundation/traceflow/index.html#module-pcapkit.foundation.traceflow" title="pcapkit.foundation.traceflow"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.foundation.traceflow</span></code></a> modules for more information about the
reassembly and flow tracing classes, as well as the underlying algorithms.</p>
</div>
<section id="new-implementation">
<h4>New Implementation<a class="headerlink" href="#new-implementation" title="Link to this heading">¶</a></h4>
<p>To add a new reassembly or flow tracing class, you need to create a new class
inherited from <a class="reference internal" href="pcapkit/foundation/reassembly/reassembly.html#pcapkit.foundation.reassembly.reassembly.Reassembly" title="pcapkit.foundation.reassembly.reassembly.Reassembly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reassembly</span></code></a>
or <a class="reference internal" href="pcapkit/foundation/traceflow/traceflow.html#pcapkit.foundation.traceflow.traceflow.TraceFlow" title="pcapkit.foundation.traceflow.traceflow.TraceFlow"><code class="xref py py-class docutils literal notranslate"><span class="pre">TraceFlow</span></code></a> class, which
is responsible for reassembling or tracing the network packets for further
processing.</p>
<p>The following code snippet shows how to create a new reassembly class:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Following is a PoC implementation of a new reassembly class for the IPv4
protocol. For documentation purposes, we use the
<a class="reference internal" href="pcapkit/foundation/reassembly/ip/ipv4.html#pcapkit.foundation.reassembly.ipv4.IPv4" title="pcapkit.foundation.reassembly.ipv4.IPv4"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPv4</span></code></a> reassembly class as an
example, where the comprehensive implementation can be found in the
<a class="reference internal" href="pcapkit/foundation/reassembly/ip/ipv4.html#module-pcapkit.foundation.reassembly.ipv4" title="pcapkit.foundation.reassembly.ipv4"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.foundation.reassembly.ipv4</span></code></a> module.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.corekit.infoclass</span><span class="w"> </span><span class="kn">import</span> <span class="n">Info</span><span class="p">,</span> <span class="n">info_final</span>  <span class="c1"># import Info class for data model definitions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.protocols.internet.ipv4</span><span class="w"> </span><span class="kn">import</span> <span class="n">IPv4</span>  <span class="c1"># import protocol class for attribute definitions</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pcapkit.foundation.reassembly.reassembly</span><span class="w"> </span><span class="kn">import</span> <span class="n">Reassembly</span>  <span class="c1"># import base class</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TypeAlias</span>

<span class="c1"># NOTE: We need to specify some useful data structure before creating the</span>
<span class="c1"># reassembly class, e.g., the data model for the reassembled packet, the</span>
<span class="c1"># data model for the reassembly table, etc., which will be used to store</span>
<span class="c1"># the reassembled packet and the reassembly table, respectively.</span>

<span class="n">BufferID</span><span class="p">:</span> <span class="s1">&#39;TypeAlias&#39;</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># a tuple-like object to identify the reassembly</span>
                             <span class="c1"># table entry&#39;s ID, e.g., (src, dst, id, proto)</span>
                             <span class="c1"># for IPv4, (src, dst, spi) for IPv6, etc.</span>


<span class="nd">@info_final</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Packet</span><span class="p">(</span><span class="n">Info</span><span class="p">):</span>

    <span class="c1"># NOTE: This is the data model for the extracted packet, which is</span>
    <span class="c1"># expected to be a dict-like object, and will be used to store the</span>
    <span class="c1"># information from the extracted packets to be reassembled.</span>
    <span class="o">...</span>


<span class="nd">@info_final</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DatagramID</span><span class="p">(</span><span class="n">Info</span><span class="p">):</span>

    <span class="c1"># NOTE: This is the data model for the reassembled datagram&#39;s ID,</span>
    <span class="c1"># which is expected to be a dict-like object, and will be used to</span>
    <span class="c1"># store the information to identify the reassembled datagram.</span>
    <span class="o">...</span>


<span class="nd">@info_final</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Datagram</span><span class="p">(</span><span class="n">Info</span><span class="p">):</span>

    <span class="c1"># NOTE: This is the data model for the reassembled datagram, which</span>
    <span class="c1"># is expected to be a dict-like object, and will be used to store</span>
    <span class="c1"># the information of the reassembled datagram.</span>
    <span class="o">...</span>


<span class="nd">@info_final</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Buffer</span><span class="p">(</span><span class="n">Info</span><span class="p">):</span>

    <span class="c1"># NOTE: This is the data model for the reassembly table, which is</span>
    <span class="c1"># expected to be a dict-like object, and will be used to store the</span>
    <span class="c1"># information of each buffered entry in the reassembly table, that</span>
    <span class="c1"># is to be reassembled with the following fragmented packets.</span>
    <span class="o">...</span>


<span class="c1"># NOTE: Now we can create the reassembly class, which is expected to be</span>
<span class="c1"># a subclass of the base class, i.e., Reassembly, and implement the core</span>
<span class="c1"># methods, i.e., reassembly and submit, for reassembling the fragmented</span>
<span class="c1"># packets and submitting the reassembled datagram, respectively.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyReassembly</span><span class="p">(</span><span class="n">Reassembly</span><span class="p">[</span><span class="n">Packet</span><span class="p">,</span> <span class="n">Datagram</span><span class="p">,</span> <span class="n">BufferID</span><span class="p">,</span> <span class="n">Buffer</span><span class="p">]):</span>

    <span class="n">__protocol_name__</span> <span class="o">=</span> <span class="s1">&#39;IPv4&#39;</span>  <span class="c1"># name of the protocol</span>
    <span class="n">__protocol_type__</span> <span class="o">=</span> <span class="n">IPv4</span>  <span class="c1"># type of the protocol</span>

    <span class="c1"># NOTE: This method is to reassemble the fragmented packets, i.e.,</span>
    <span class="c1"># ``info`` formatted as a ``Packet`` instance, into the reassembly</span>
    <span class="c1"># table, i.e., ``self._buffer`` formatted as a dict of ``BufferID``</span>
    <span class="c1"># mapped to ``Buffer`` instances.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">reassembly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">:</span> <span class="s1">&#39;Packet&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
        <span class="o">...</span>  <span class="c1"># reassembly algorithm implementation</span>

        <span class="c1"># NOTE: Once the fragmented packets are reassembled, we need to</span>
        <span class="c1"># submit the reassembled datagram, i.e., ``Datagram`` instance,</span>
        <span class="c1"># to the storage, i.e., ``self._dtgram``, for further processing.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtgram</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># submit reassembled datagram</span>
        <span class="p">)</span>

    <span class="c1"># NOTE: This method is to convert the reassembled datagram, i.e.,</span>
    <span class="c1"># ``buf`` formatted as a ``Buffer`` instance, to a ``Datagram``</span>
    <span class="c1"># instance, which is then submitted to the storage, i.e.,</span>
    <span class="c1"># ``self._dtgram``.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buf</span><span class="p">:</span> <span class="s1">&#39;Buffer&#39;</span><span class="p">,</span> <span class="o">*</span> <span class="p">,</span> <span class="n">bufid</span><span class="p">:</span> <span class="s1">&#39;BufferID&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;list[Datagram]&#39;</span><span class="p">:</span>
        <span class="n">datagram</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># submit algorithm implementation, e.g., to convert</span>
                        <span class="c1"># the reassembled datagram to a list of ``Datagram``</span>
                        <span class="c1"># instances, which is then returned for further</span>
                        <span class="c1"># processing by the caller</span>

        <span class="c1"># NOTE: Before we submit the reassembled datagram, we need to</span>
        <span class="c1"># run the registered callback functions, if any, to process the</span>
        <span class="c1"># reassembled datagram, e.g., to check if the reassembled datagram</span>
        <span class="c1"># is to be discarded, etc.</span>
        <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__callback_fn__</span><span class="p">:</span>
            <span class="n">callback</span><span class="p">(</span><span class="n">datagram</span><span class="p">)</span>  <span class="c1"># run callback functions</span>
        <span class="k">return</span> <span class="n">datagram</span>
</pre></div>
</div>
</section>
<section id="callback-functions">
<h4>Callback Functions<a class="headerlink" href="#callback-functions" title="Link to this heading">¶</a></h4>
<p>It is possible to register callback functions to the reassembly and flow
tracing classes, which will be called at the end of the reassembly and
flow tracing process, respectively. This feature is designed to create
the ability to process the reassembled datagrams and/or flows, e.g., to
check if the datagram and/or flows are to be discarded, etc.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>For more information, you may refer to the documentation of
<a class="reference internal" href="pcapkit/foundation/registry.html#module-pcapkit.foundation.registry.foundation" title="pcapkit.foundation.registry.foundation"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pcapkit.foundation.registry.foundation</span></code></a> for the callback
registry functions:</p>
<ul class="simple">
<li><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.foundation.register_reassembly_ipv4_callback" title="pcapkit.foundation.registry.foundation.register_reassembly_ipv4_callback"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_reassembly_ipv4_callback()</span></code></a></p></li>
<li><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.foundation.register_reassembly_ipv6_callback" title="pcapkit.foundation.registry.foundation.register_reassembly_ipv6_callback"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_reassembly_ipv6_callback()</span></code></a></p></li>
<li><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.foundation.register_reassembly_tcp_callback" title="pcapkit.foundation.registry.foundation.register_reassembly_tcp_callback"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_reassembly_tcp_callback()</span></code></a></p></li>
<li><p><a class="reference internal" href="pcapkit/foundation/registry.html#pcapkit.foundation.registry.foundation.register_traceflow_tcp_callback" title="pcapkit.foundation.registry.foundation.register_traceflow_tcp_callback"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_traceflow_tcp_callback()</span></code></a></p></li>
</ul>
</div>
<p>All callback functions are expected to be a callback function, which
accepts a single argument, i.e., the list of reassembled datagrams
and/or flows, and returns <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>. Any return value will be ignored.</p>
<p>It is possible to modify the reassembled datagrams and/or flows in the
callback functions, e.e., to discard certain reassembled datagrams and/or
flows, etc. However, it is not recommended to modify the reassembled
datagrams and/or flows directly. Should that is the intended behaviour,
you should create a new reassembly and/or flow tracing class, and modify
the corresponding reassembly and/or flow tracing algorithm.</p>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="demo.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">How to …</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="pcapkit/vendor/http.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTTP</span></code> Vendor Crawler</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2017-2025, Jarry Shaw
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Customisation &amp; Extensions</a><ul>
<li><a class="reference internal" href="#what-s-in-for-protocols">What’s in for Protocols?</a><ul>
<li><a class="reference internal" href="#new-protocol">New Protocol</a><ul>
<li><a class="reference internal" href="#samples">Samples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extending-existing-protocol">Extending Existing Protocol</a></li>
</ul>
</li>
<li><a class="reference internal" href="#and-speaking-of-library-foundations">And Speaking of Library Foundations…</a><ul>
<li><a class="reference internal" href="#extractor-engines">Extractor Engines</a><ul>
<li><a class="reference internal" href="#id1">Samples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#output-dumpers">Output Dumpers</a><ul>
<li><a class="reference internal" href="#id2">Samples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reassembly-and-flow-tracing">Reassembly and Flow Tracing</a><ul>
<li><a class="reference internal" href="#new-implementation">New Implementation</a></li>
<li><a class="reference internal" href="#callback-functions">Callback Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=ca98b11e"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=4e2eecee"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    </body>
</html>